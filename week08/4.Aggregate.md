# 4. Aggregate

## 학습 키워드

- 집합체 (Aggregate)
- 불변식
- 트랜잭션적 일관성과 결과적 일관성

***

### 집합체 (Aggregate)

- 집합체는 도메인 모델의 일부로서, 하나의 개념적인 단위로 묶여 있는 객체들의 집합이다.

- 불변식(Invariant)을 유지하고 여러 도메인 객체를 사용하기 좋게 만들어 준다.

- Entity와 Value Object는 도메인 모델, 도메인 객체가 맞지만, 우리는 Entity와 Value Object를 바로 사용하지 않을 것이다.

- 이는 마치 우리가 타이어와 엔진을 직접 사용하지 않고, 자동차라는 집합체를 사용하는 것과 같다.

### 불변식

- 불변식은 우리가 지켜야 할 제약 조건, 규칙이라고 할 수 있다.

- 비즈니스 규칙에 따라 도메인 모델이 일관되고 유효하게 유지되는 조건을 정의한다.

- 집합체 단위로 불변식을 정의한다.

- Aggregate Root는 불변식을 지키기 위한 경계를 정의한다.

### 트랜잭션적 일관성과 결과적 일관성

- 트랜잭션 일관성 : 데이터가 변경되면 즉시 다음 읽기 작업에 반영되도록 보장한다.

- 결과적 일관성 : 데이터가 변경되면 충분한 시간이 주어지고 최종적으로 모두 일관된 상태로 수렴하도록 보장한다.

- 트랜잭션 일관성은 즉각적인 데이터 일관성을 보장하지만 시스템 가용성 및 성능에 영향을 미칠 수 있다.

- 반면 결과적 일관성은 애플리케이션 논리에서 처리하기 어려울 수 있는 일시적인 불일치를 대가로 시스템 가용성 및 성능을 최적화합니다.
