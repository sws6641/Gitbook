# 2. Unit Test

### 학습 키워드

- V 모델
- Test Matrix
- 내적 품질(테스트 코드 작성등)을 높이면 좋은 이유
- JUnit
- 단위 테스트
- E2E 테스트

***

### V 모델

* 정의

    * 소프트웨어 개발의 각 단계마다 상세한 문서화를 통해 작업을 진행하는 잘 짜인 방법을 사용하며

    * 테스트 활동을 코딩 이후가 아닌 프로젝트 시작 시점에 함께 진행하여, 전체적으로 많은 양의 프로젝트 비용과 시간을 감소시킬 수 있다.

    * 폭포수 모델의 변형이다.

        * 폭포수 모델 - 소프트웨어 개발 시 단계적으로 개발하는 방법론

        * 폭포수가 거슬러 올라갈 수 없듯이, 소프트웨어 개발도 반드시 앞 단계가 먼저 완료되어야 다음 단계의 개발을 진행할 수 있다는 뜻
    
    * 폭포수 모델에서 테스트 단계를 중점적으로 추가한 모델

* 장점

    * 모든 단계에 검증과 확인이 있어서 오류를 줄일 수 있다.

    * 높은 신뢰도를 요구하는 프로젝트 에 적합한 모델

* 단점

    * 이미 작업이 끝나버리면 변경이 쉽지 않다

### Test Matrix

* 테스트를 위한 템플릿

* 테스트를 세분화한 시트

* 보통 시각적으로 보이는 것은 외적품질, 클린코드와 같은 것들을 내적품질이라고 말할 수 있다.

### 내적 품질(테스트 코드 작성등)을 높이면 좋은 이유

#### 내부 품질 vs. 외부 품질

* 외부 품질

    * 소프트웨어의 기능 작동 여부, 속도 등 사용자 입장에서의 품질을 의미

    * 일반적으로 생각하는 '품질'의 개념

* 내부 품질

    * 소프트웨어의 내부 구성이 잘 되어 있는지 여부를 의미
    
    * Clean Code 개념은 내부 품질 개선을 위한 것으로, 사용자에게 직접 드러나는 사항은 아님

    * 장점

        * 협업에 유리 (코드를 알아보기 쉬움)

        * 유지보수에 유리 (문제사항 대응, 업데이트 등이 보다 편리)

        * 결과적으로 외적 품질 유지에도 유리


### JUnit

* 정의

    * Java의 단위테스트(Unit Test)를 수행해주는 대표적인 Testing Framework

    * Testing 결과를 단순히 문서로 남기는 것이 아니라 Test Class를 그대로 남김으로써 추 후 개발자에게 테스트 방법 및 클래스의 History를 넘겨줄 수 있다.

    * 단위 테스트만 지원하는 건 아님. 통합 테스트, 심지어는 E2E 테스트를 작성하는데도 사용

* 역사(등장배경)

    * JUnit 등장 이전에 main에서 테스트를 했었고 많은 문제가 있었다.

    * main의 문제점

        * 구현 코드와 테스트 코드가 클래스 하나에 존재한다. 클래스 크기가 커짐. 복잡도 증가함.

        * 테스트 코드가 실 서비스에 같이 배포됨.

        * 메인 함수 하나에서 여러 개의 기능을 테스트 함. 복잡도 증가.

        * 함수 이름을 통해 어떤 부분을 테스트하는지에 대한 의도를 드러내기 힘듦.

        * 테스트 결과를 사람이 수동으로 확인

* 특징 (장점)
    * 자바 프로그래밍 언어용 유닛 테스트 프레임워크(단위 테스트 Framework중 하나)

    * 테스트 결과는 Test클래스로 개발자에게 테스트 방법 및 클래스의 History를 공유 가능

    * 단정(assert) 메서드로 테스트 케이스의 수행 결과를 판별

    * 어노테이션으로 간결하게 지원(JUnit4부터)

<br>

> JUnit 5 = JUnit plattform + JUnit Jupiter + JUnit Vintage

* JUnit Platform

    * JVM에서 테스트 프레임워크를 시작하기 위한 기반 역할을 한다.

    * 테스트하기 위한 TestEngine API를 제공한다.

    * Command line을 사용할 수 있는 Console Launcher 제공한다.

    * JUnit 4 기반의 테스트를 제공

* JUnit Jupiter

    * JUnit 5에서 테스트 및 확장을 위한 새로운 프로그래밍 모델과 확장 모델의 조합이다.

    * Platform에서 Jupiter 기반 테스트를 실행하기위한 TestEngine을 제공한다.

* JUnit Vintage

    * Platform에서 JUnit 3와 JUnit 4 기반의 테스트를 할 수 있는 TestEngine을 제공한다.

### 단위 테스트(Unit Test)

* 정의

    * 하나의 모듈을 기준으로 독립적으로 진행되는 가장 작은 단위의 테스트

        * 모듈 - 애플리케이션에서 작동하는 하나의 기능 또는 메소드
        
        <br/>

    * 애플리케이션을 구성하는 하나의 기능이 올바르게 동작하는지를 독립적으로 테스트하는 것

    * 예를 들어 웹 애플리케이션에서 로그인 메소드에 대한 독립적인 테스트가 1개의 단위테스트가 될 수 있다.

* 특징

    * 테스팅에 대한 시간과 비용을 절감할 수 있다.

    * 새로운 기능 추가 시에 수시로 빠르게 테스트 할 수 있다.

    * 리팩토링 시에 안정성을 확보할 수 있다.

    * 코드에 대한 문서가 될 수 있다.

#### 좋은 단위 테스트의 특징

* 1개의 테스트 함수에 대해 assert를 최소화하라

* 1개의 테스트 함수는 1가지 개념 만을 테스트하라

#### 좋고 깨끗한 테스트 코드 - FIRST라는 5가지 규칙

1. Fast: 테스트는 빠르게 동작하여 자주 돌릴 수 있어야 한다.

2. Independent: 각각의 테스트는 독립적이며 서로 의존해서는 안된다.

3. Repeatable: 어느 환경에서도 반복 가능해야 한다.

4. Self-Validating: 테스트는 성공 또는 실패로 bool 값으로 결과를 내어 자체적으로 2. 검증되어야 한다.

5. Timely: 테스트는 적시에 즉, 테스트하려는 실제 코드를 구현하기 직전에 구현해야 한다.

### E2E 테스트(End to End)

* 정의

    * 시스템의 시작부터 끝까지 전체 흐름을 확인하는 테스트 유형이다.

    * 시스템이 예상대로 작동하고 사용자의 요구 사항을 충족하는지 확인하기 위해 모든 구성 요소와 해당 구성 요소의 상호 작용을 테스트하는 것이 포함된다.

    * 사용자의 입장에서 전체 Flow가 정상적으로 동작을 하는지 확인한다. 

* 왜 필요한가/왜 생겼는가

    * E2E 테스트를 완료하기에 가장 좋은 시기는 개발 프로세스가 끝날 무렵이다.

    * 고객이 사용하는 대부분의 기능이 소프트웨어에 포함되어 있기 때문이다.

* 장점

    * 결함 감지

    * 사용자 관점 이해

    * 개발자 신뢰도 향상

* 단점

    * 느린 실행

    * 복잡한 테스트 환경

    * 어려운 디버깅